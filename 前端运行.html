<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>

  <!-- 建议使用明确的协议（https:），避免使用协议相对URL（//） -->
  <!-- 引入ElementPlus样式 -->
  <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css" />
  <!-- 引入Vue 3 -->
  <script src="https://unpkg.com/vue@3"></script>
  <!-- 引入ElementPlus组件库 -->
  <script src="https://unpkg.com/element-plus"></script>
  <!-- 引入ElementPlus icon组件库 -->
  <script src="https://unpkg.com/@element-plus/icons-vue"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/@element-plus/icons-vue"></script> -->
  <!-- 引入SheetJS (xlsx)库 -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <link rel="stylesheet" href="./css/index.css" />
</head>

<body>
  <div id="app">
    <div class="header-container">
      <div class="upload-product-excel">
        <el-upload
          drag
          action="#"
          accept=".xlsx, .xls, .csv"
          class="component-upload"
          :file-list="productFileList"
          :limit="1"
          :auto-upload="false"
          :on-change="handleFileChange"
        >
          <!-- <el-icon class="el-icon--upload"><upload-filled /></el-icon> -->
          <el-icon size="30"><Plus /></el-icon>
          <!-- <div class="el-upload__text">将Coupang产品Excel文件拖到此处，或<em>点击上传</em></div> -->
          <div class="el-upload__text">将Excel文件拖到框内，或
            <div>
              <em>点击上传</em>
            </div>
          </div>

          <template #file="{ file }">
            <div class="component-upload-slot-filelist">
              <div class="file-container">
                <svg width="28" height="28" t="1765910580191" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8570" width="200" height="200"><path d="M951.296 682.496c12.8 0 21.504-9.216 21.504-22.528V287.232L801.28 102.4H323.584c-47.104 0-85.504 40.448-85.504 90.112v74.24H94.208c-23.552 0-43.008 20.48-43.008 45.056v446.976c0 25.088 19.456 45.056 43.008 45.056h143.36v58.368c0 49.664 38.4 90.112 85.504 90.112h563.712c47.104 0 85.504-40.448 85.504-90.112v-67.584c0-13.312-8.704-22.528-21.504-22.528s-21.504 9.216-21.504 22.528v67.584c0 25.088-19.456 45.056-43.008 45.056H323.584c-23.552 0-43.008-20.48-43.008-45.056v-58.88h235.52c23.552 0 43.008-20.48 43.008-45.056V312.32c0-24.576-19.456-45.056-43.008-45.056h-235.52V192.512c0-25.088 19.456-45.056 43.008-45.056h435.2v117.248c0 36.352 27.648 67.584 64.512 67.584h107.008v327.168c-0.512 13.824 8.192 23.04 20.992 23.04zM304.128 499.712l47.104-72.192h64.512l-75.264 112.64 90.112 131.072h-66.56l-57.856-85.504-57.856 85.504h-66.56l90.112-131.072-77.312-112.64h66.56l43.008 72.192z m518.656-212.48c-12.8 0-21.504-9.216-21.504-22.528V165.376l111.616 121.856h-90.112z" fill="#45B058" p-id="8571"></path><path d="M739.84 693.248h-101.376c-12.288 0-20.48 9.216-20.48 23.552s8.192 23.552 20.48 23.552h101.376c12.288 0 19.968-9.216 19.968-23.552 0.512-14.336-7.68-23.552-19.968-23.552z m0-118.272h-101.376c-12.288 0-20.48 9.216-20.48 23.552s8.192 23.552 20.48 23.552h101.376c12.288 0 19.968-9.216 19.968-23.552s-7.68-23.552-19.968-23.552z m0-118.272h-101.376c-12.288 0-20.48 9.216-20.48 23.552s8.192 23.552 20.48 23.552h101.376c12.288 0 19.968-9.216 19.968-23.552 0.512-13.824-7.68-23.552-19.968-23.552z" fill="#45B058" p-id="8572"></path></svg>

                <el-text truncated style="margin-left: 6px;">
                  {{ `${file.name}(${formatSize(file.size)})` }}
                </el-text>
              </div>

              <!-- 删除按钮 -->
              <el-icon @click="handleRemove(file)" class="file-remove-btn"><Close /></el-icon>
            </div>
          </template>
        </el-upload>
  
          <!-- 用于展示解析后的JSON数据或分析结果 -->
          <!-- 这里可以进一步展示或处理 jsonData -->
          <!-- 预览前两条数据 -->
          <!-- <div v-if="jsonData.length > 0" class="data-preview">
            <div>解析成功！共获取 {{ jsonData.length }} 条产品记录</div>
            <pre>{{ JSON.stringify(jsonData.slice(0, 2), null, 2) }}</pre>
          </div> -->
      </div>
  
      <div class="merge-description">
        <template v-if="!mergeInfoList.length">
          <el-text size="large" type="success" style="display: flex; align-items: center;">
            <!-- <el-icon><Check /></el-icon> -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" style="width: 28px; margin-right: 4px;">
              <path fill="currentColor"
                d="M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.27 38.27 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z">
              </path>
            </svg>
            未检测到被合并曝光商品信息
          </el-text>
          <!-- <div class="empty-merge-list">
            未检测到被合并曝光商品信息
          </div> -->
        </template>
        <template v-else>
          <el-descriptions title="被合并曝光商品信息" border>
            <template v-for="(obj, index) in mergeInfoList">
              <el-descriptions-item label-width="120" width="120" :label="`${index + 1}. 商品曝光ID`""
                  >{{ obj.PID }}</el-descriptions-item
                >
                <el-descriptions-item label-width=" 120" width="80" label="合并商品个数">{{ obj.ridList.length
                }}</el-descriptions-item>
              <el-descriptions-item label-width="120" label="合并产品">
                {{ obj.skuList.map(item => item.PN).join(", ") }}
              </el-descriptions-item>
            </template>
          </el-descriptions>
        </template>
      </div>
    </div>

    <div class="product-table">
      <div class="search-box">
        <!-- 商品曝光id搜索框 -->
        <div class="search-box-item">
          <el-input v-model="searchForm.PID" style="width: 320px" placeholder="输入商品曝光ID" clearable>
            <template #prepend>
              商品曝光ID
            </template>

            <template #append>
              <el-checkbox v-model="searchForm.PID_first" label="优先" size=""></el-checkbox>
            </template>
          </el-input>
        </div>

        <!-- 注册商品id搜索框 -->
        <div class="search-box-item">
          <el-input v-model="searchForm.RID" style="width: 320px" placeholder="输入注册商品ID" clearable>
            <template #prepend>
              注册商品ID
            </template>

            <template #append>
              <el-checkbox v-model="searchForm.RID_exclude" label="取反" size=""></el-checkbox>
            </template>
          </el-input>
        </div>

        <!-- 与、或 下拉选项框 -->
        <div class="search-box-item">
          <el-select v-model="searchForm.union" placeholder="选择查询方法" style="width: 80px">
            <el-option :key="0" label="或" :value="0"></el-option>
            <el-option :key="1" label="与" :value="1"></el-option>
          </el-select>
        </div>

        <div class="search-btns">
          <el-button type="primary" @click="handleSearch">
            <svg style="width: 14px; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
              <path fill="currentColor"
                d="m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704">
              </path>
            </svg>搜索
          </el-button>
          <el-button type="danger" @click="handleReset">
            <svg style="width: 14px; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
              <path fill="currentColor"
                d="M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z">
              </path>
            </svg>
            重置
          </el-button>
        </div>
      </div>
      <el-table
        border
        style="width: 100%"
        align=""
        empty-text="空数据"
        v-loading="tableLoading"
        height="calc(100vh - 246px)"
        :header-cell-style="{
          backgroundColor: '#F6F9FC',
          color: '#82909F'
        }"
        :data="mergeProducts"
        :span-method="PIDSpanMethod"
      >
        <el-table-column label="商品曝光ID">
          <template #default="scope">
            <div style="display: flex; align-items: center; justify-content: center;">
              <el-link type="primary" @click="openCoupangLink(scope.row)">{{ scope.row.PID }}</el-link>
            </div>
          </template>
        </el-table-column>
        <el-table-column label="注册商品ID" prop="indexRID" width="160"></el-table-column>
        <el-table-column label="产品管理名称" prop="PN"></el-table-column>
        <el-table-column label="SKU名称" prop="SKUNAME"></el-table-column>
        <el-table-column label="SKU编码" prop="SKUID"></el-table-column>
        <el-table-column prop="VID">
          <template #header="scope">
            <div style="display: flex;justify-content:space-around;align-items:center;">
              <span>选项ID</span>
              <el-button size="" text type="primary" @click="handleCopy(scope.$index, scope.row)">
                复制整列
              </el-button>
            </div>
          </template>
        </el-table-column>
      </el-table>
    </div>
  </div>

  <!-- 引入产品数组js文件 -->
  <!-- <script src="./产品信息JSON/20251212-产品信息json.js"></script> -->
  <script src="./产品信息JSON/20251212-产品信息json.js"></script>

  <!-- vue应用代码文件 -->
  <script src="./js/main.js"></script>

  <script>
    // fetch('https://www.coupang.com/next-api/products/quantity-info?productId=9239798438&vendorItemId=94271584245')
    //   .then(response => {
    //     console.log('response', response);
        
    //     // 检查响应是否成功
    //     if (!response.ok) {
    //       throw new Error('网络响应异常');
    //     }
    //     // 解析JSON格式的响应
    //     return response.json();
    //   })
    //   .then(code => {
    //     console.log('data', data);
    //   });
  </script>
</body>

</html>